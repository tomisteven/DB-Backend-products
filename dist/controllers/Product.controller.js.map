{"version":3,"file":"Product.controller.js","names":["createProduct","req","res","body","name","description","price","newProduct","Product","console","log","files","image","uploadImage","tempFilePath","result","public_id","secure_url","fs","unlink","save","redirect","getProducts","find","product","json","getProduct","id","params","findById","deleteProduct","deleteImagen","remove","message","editProduct"],"sources":["../../src/controllers/Product.controller.js"],"sourcesContent":["//importamos base de datos\r\nimport  Product  from '../models/Product.js';\r\n\r\nimport {uploadImage, deleteImagen} from '../cloudinary.js';\r\nimport fs from 'fs-extra'\r\n\r\n \r\nconst createProduct = async (req, res) => {\r\n\r\n    try {\r\n\r\n    const { \r\n        name,\r\n        description,\r\n        price\r\n     } = req.body;\r\n     const newProduct = new Product({  name, description, price });\r\n\r\n     //ver objeto con null y undefined\r\n     console.log(req.files);\r\n     \r\n    if (req.files?.image) {\r\n        const result = await uploadImage(req.files.image.tempFilePath);\r\n        newProduct.image = {\r\n          public_id: result.public_id,\r\n          secure_url: result.secure_url\r\n        }\r\n        await fs.unlink(req.files.image.tempFilePath)\r\n      } \r\n\r\n\r\n     await newProduct.save(); \r\n\r\n     \r\n     //ir a pagina de productos\r\n     res.redirect('http://localhost:3000');\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nconst getProducts = async (req, res) => {\r\ntry {\r\n    const product = await Product.find();\r\n    res.json(product);\r\n    \r\n} catch (error) {\r\n    console.log(error);\r\n}\r\n}\r\n\r\nconst getProduct = async (req, res) => {\r\n    try {\r\n        const { id } = req.params;\r\n    const product = await Product.findById(id);\r\n    res.json(product);\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nconst deleteProduct = async (req, res) => {\r\n    try {\r\n\r\n        const { id } = req.params;\r\n        const product = await Product.findById(id);\r\n        await deleteImagen(product.image.public_id);\r\n        await product.remove();\r\n        res.json({ message: 'product deleted' });\r\n\r\n    } catch (error) {\r\n        console.log(error);\r\n        \r\n    }\r\n\r\n}\r\n\r\nconst editProduct = async (req, res) => {\r\n    try {\r\n        const { id } = req.params;\r\n        const {name, description, price} = req.body;\r\n\r\n        const product = await Product.findById(id);\r\n        product.name = name;\r\n        product.description = description;\r\n        product.price = price;\r\n        await product.save();\r\n        \r\n        res.json({ message: 'product Saved' }); \r\n    } catch (error) {\r\n\r\n        console.log(error);\r\n\r\n    }\r\n    \r\n}\r\n\r\n\r\n\r\nexport {\r\n    createProduct,\r\n    getProducts,\r\n    deleteProduct,\r\n    editProduct,\r\n    getProduct\r\n}"],"mappings":"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"}